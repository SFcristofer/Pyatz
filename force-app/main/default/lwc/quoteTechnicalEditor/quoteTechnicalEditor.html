<template>
    <div class="main-container">
        <!-- HEADER CON PROGRESO (Ahora 4 Pasos) -->
        <div class="slds-p-around_medium bg-white border-bottom">
            <lightning-progress-indicator current-step={currentStep} type="path" variant="base">
                <lightning-progress-step label="Contrato" value="1"></lightning-progress-step>
                <lightning-progress-step label="Datos Técnicos" value="2"></lightning-progress-step>
                <lightning-progress-step label="Detalles" value="3"></lightning-progress-step>
                <lightning-progress-step label="Finalizar" value="4"></lightning-progress-step>
            </lightning-progress-indicator>
        </div>

        <div class="slds-p-around_large content-area">
            
            <!-- PASO 1: ORIGEN Y ESTRATEGIA (NUEVO) -->
            <template if:true={isStep1}>
                <!-- Estrategia de Venta -->
                <div class="section-card slds-m-bottom_large">
                    <div class="section-header">
                        <div class="slds-grid slds-grid_vertical-align-center">
                            <div class="blue-square slds-m-right_small"></div>
                            <h2 class="slds-text-heading_small">Estrategia de Venta</h2>
                        </div>
                    </div>
                    <div class="slds-p-around_large">
                        <p class="slds-m-bottom_medium text-muted">Defina la categoría de este servicio para la trazabilidad operativa.</p>
                        <lightning-radio-group name="estrategiaVenta"
                            label="Categoría"
                            options={estrategiaOptions}
                            value={estrategiaVenta}
                            type="button"
                            variant="label-hidden"
                            class="custom-radio-group">
                        </lightning-radio-group>
                    </div>
                </div>

                <!-- Origen: Necesidad / Levantamiento -->
                <div class="section-card slds-m-bottom_large">
                    <div class="section-header">
                        <div class="slds-grid slds-grid_vertical-align-center">
                            <div class="blue-square slds-m-right_small"></div>
                            <h2 class="slds-text-heading_small">Origen: Necesidad o Levantamiento</h2>
                        </div>
                    </div>
                    <div class="slds-p-around_large">
                        <div class="slds-grid slds-wrap slds-gutters slds-grid_vertical-align-end">
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_2-of-3">
                                <lightning-input type="search" label="Buscar Necesidad / Levantamiento relacionado" placeholder="Escriba el nombre o folio..."></lightning-input>
                            </div>
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-3">
                                <lightning-button label="Nuevo Levantamiento" icon-name="utility:add" variant="neutral" class="slds-size_1-of-1"></lightning-button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Vinculación de Contrato y Tipo de Orden (OCULTO TEMPORALMENTE) -->
                <!-- <div class="section-card slds-m-bottom_large">
                    <div class="section-header">
                        <div class="slds-grid slds-grid_vertical-align-center">
                            <div class="blue-square slds-m-right_small"></div>
                            <h2 class="slds-text-heading_small">Contrato y Orden de Trabajo</h2>
                        </div>
                    </div>
                    <div class="slds-p-around_large">
                        <div class="slds-grid slds-wrap slds-gutters">
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-combobox name="tipoOrden" label="Tipo de Orden" options={tipoOperacionOptions} placeholder="Seleccione el tipo..."></lightning-combobox>
                            </div>
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-input type="text" label="Número de Contrato (Objeto Personalizado)" placeholder="Ingrese o busque el contrato..."></lightning-input>
                            </div>
                        </div>
                        <div class="slds-m-top_medium">
                            <lightning-input type="checkbox" label="Vincular automáticamente este presupuesto al contrato amparado"></lightning-input>
                        </div>
                    </div>
                </div> -->
            </template>

            <!-- PASO 2: DATOS TÉCNICOS -->
            <template if:true={isStep2}>
                <div class="section-card slds-m-bottom_large">
                    <div class="section-header">
                        <lightning-icon icon-name="utility:info" size="small" class="slds-m-right_small"></lightning-icon>
                        <h2 class="slds-text-heading_small">Información del Presupuesto</h2>
                    </div>
                    <div class="slds-p-around_large">
                        <div class="slds-grid slds-wrap slds-gutters">
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-input type="text" label="Número de Presupuesto" value="PRE-4606" readonly variant="label-stacked"></lightning-input>
                            </div>
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-input type="text" label="Asunto del presupuesto" variant="label-stacked"></lightning-input>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SECCIÓN INTRODUCCIÓN (NUEVA) -->
                <div class="section-card slds-m-bottom_large">
                    <div class="section-header">
                        <lightning-icon icon-name="utility: announcement" size="small" class="slds-m-right_small"></lightning-icon>
                        <h2 class="slds-text-heading_small">Introducción</h2>
                    </div>
                    <div class="slds-p-around_large">
                        <lightning-input-rich-text placeholder="Escriba la introducción aquí..." label="Texto de Introducción"></lightning-input-rich-text>
                    </div>
                </div>

                <!-- SECCIÓN CONDICIONES Y CLÁUSULAS (COMENTADO: Se definirá al final de la cotización) -->
                <!-- 
                <div class="section-card slds-m-bottom_large">
                    <div class="section-header">
                        <lightning-icon icon-name="utility:description" size="small" class="slds-m-right_small"></lightning-icon>
                        <h2 class="slds-text-heading_small">Condiciones y Cláusulas</h2>
                    </div>
                    <div class="slds-p-around_large">
                        <lightning-combobox label="Plantilla de cláusulas" options={templateOptions} placeholder="Seleccione una plantilla..." class="slds-m-bottom_medium"></lightning-combobox>
                        <lightning-input-rich-text value={clausulasValue} placeholder="Escriba las condiciones aquí..." label="Contenido del Anexo"></lightning-input-rich-text>
                    </div>
                </div> 
                -->

                <div class="section-card slds-m-bottom_large">
                    <div class="section-header">
                        <lightning-icon icon-name="utility: Tower" size="small" class="slds-m-right_small"></lightning-icon>
                        <h2 class="slds-text-heading_small">Línea de Negocio</h2>
                    </div>
                    <!-- NOTA TÉCNICA: Estas opciones se filtrarán dinámicamente según el campo 'Familia de Producto' -->
                    <div class="slds-p-around_large">
                        <div class="slds-grid slds-wrap">
                            <template for:each={lineaNegocioOptions} for:item="option">
                                <div key={option.value} class="slds-col slds-size_1-of-2 slds-medium-size_1-of-4 slds-p-around_xx-small">
                                    <div class="custom-checkbox-card"><lightning-input type="checkbox" label={option.label}></lightning-input></div>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>

                <div class="section-card slds-m-bottom_large">
                    <div class="section-header">
                        <div class="slds-grid slds-grid_vertical-align-center">
                            <div class="blue-square slds-m-right_small"></div>
                            <h2 class="slds-text-heading_small">Sedes Seleccionadas</h2>
                        </div>
                    </div>
                    <div class="datatable-container">
                        <lightning-datatable key-field="id" data={sedesData} columns={sedesColumns}></lightning-datatable>
                        <template if:false={sedesData.length}>
                            <div class="slds-p-around_xlarge slds-text-align_center slds-text-color_weak">
                                <lightning-icon icon-name="utility:database" size="large" variant="light" class="slds-m-bottom_small"></lightning-icon>
                                <p>No se han encontrado sedes vinculadas a este presupuesto.</p>
                            </div>
                        </template>
                    </div>
                </div>
            </template>

            <!-- PASO 3: DETALLES (ANTES PASO 2) -->
            <template if:true={isStep3}>
                <div class="section-card slds-m-bottom_large">
                    <div class="section-header">
                        <lightning-icon icon-name="utility:event" size="small" class="slds-m-right_small"></lightning-icon>
                        <h2 class="slds-text-heading_small">Detalles del presupuesto</h2>
                    </div>
                    <div class="slds-p-around_large">
                        <div class="slds-grid slds-gutters">
                            <div class="slds-col slds-size_1-of-2"><lightning-input type="date" label="Fecha de creación"></lightning-input></div>
                            <div class="slds-col slds-size_1-of-2"><lightning-input type="date" label="Fecha de aprobación"></lightning-input></div>
                        </div>
                    </div>
                </div>

                <div class="section-card slds-m-bottom_large">
                    <div class="section-header">
                        <lightning-icon icon-name="utility:cart" size="small" class="slds-m-right_small"></lightning-icon>
                        <h2 class="slds-text-heading_small">Servicios/Artículos</h2>
                    </div>
                    <div class="slds-p-around_none datatable-container">
                        <lightning-datatable key-field="id" data={serviciosData} columns={serviciosColumns} hide-checkbox-column></lightning-datatable>
                        <div class="slds-p-around_medium slds-grid slds-grid_align-spread bg-white border-bottom">
                            <div class="slds-grid">
                                <lightning-button label="+ Añadir servicios o artículos" variant="success" class="btn-verde slds-m-right_small" onclick={handleOpenModal}></lightning-button>
                                <lightning-button label="+ Añadir texto o Separador" variant="success" class="btn-verde"></lightning-button>
                            </div>
                            <div class="slds-grid">
                                <lightning-button label="P&L" icon-name="utility:calculator" class="btn-azul-pastel"></lightning-button>
                            </div>
                        </div>
                    </div>
                    <div class="totales-title-area">
                        <div class="slds-grid slds-grid_vertical-align-center">
                            <div class="blue-square slds-m-right_small"></div>
                            <h3 class="slds-text-title_bold">Resumen de Totales</h3>
                        </div>
                    </div>
                    <div class="slds-p-around_none datatable-container">
                        <lightning-datatable key-field="id" data={totalesData} columns={totalesColumns} hide-checkbox-column></lightning-datatable>
                    </div>
                    <div class="slds-p-around_large bg-white border-top">
                        <div class="slds-grid slds-wrap slds-gutters">
                            <div class="slds-col slds-size_1-of-3"><div class="custom-checkbox-card"><lightning-input type="checkbox" label="Mostrar el importe total del presupuesto"></lightning-input></div></div>
                            <div class="slds-col slds-size_1-of-3"><div class="custom-checkbox-card"><lightning-input type="checkbox" label="Mostrar los impuestos en el pdf"></lightning-input></div></div>
                            <div class="slds-col slds-size_1-of-3"><div class="custom-checkbox-card"><lightning-input type="checkbox" label="Mostrar el importe en las líneas"></lightning-input></div></div>
                        </div>
                    </div>
                </div>

                <div class="section-card slds-m-bottom_large">
                    <div class="slds-p-around_medium">
                        <div class="slds-grid slds-grid_vertical-align-center">
                            <div class="blue-square slds-m-right_small"></div>
                            <lightning-input type="checkbox" label="Añadir descripción/explicación" class="slds-text-title_bold"></lightning-input>
                        </div>
                    </div>
                </div>

                <!-- SECCIÓN: MÉTODO DE PAGO Y TIPO DE TRABAJO -->
                <div class="section-card slds-m-bottom_large">
                    <div class="section-header">
                        <div class="slds-grid slds-grid_vertical-align-center">
                            <div class="blue-square slds-m-right_small"></div>
                            <h2 class="slds-text-heading_small">Método de Pago</h2>
                        </div>
                    </div>
                    <div class="slds-p-around_large">
                        <div class="slds-grid slds-wrap slds-gutters">
                            <!-- Columna 1 -->
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <p class="slds-text-title_bold slds-m-bottom_small">Opciones de Pago</p>
                                <div class="slds-grid slds-wrap">
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning-input type="checkbox" label="Transferencia"></lightning-input>
                                    </div>
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning-input type="checkbox" label="Tarjeta"></lightning-input>
                                    </div>
                                </div>

                                <p class="slds-text-title_bold slds-m-top_large slds-m-bottom_small">TIPO DE TRABAJO A REALIZAR:</p>
                                <div class="slds-grid slds-grid_vertical">
                                    <lightning-input type="checkbox" label="Trabajo único/puntual"></lightning-input>
                                    <lightning-input type="checkbox" label="Contrato de mantenimiento" class="slds-m-top_xx-small"></lightning-input>
                                </div>
                            </div>

                            <!-- Columna 2 -->
                            <div class="slds-col slds-size_1-of-1 slds-medium-size_1-of-2">
                                <lightning-input type="text" label="Observaciones sobre pago" placeholder="Ingrese detalles u observaciones..."></lightning-input>
                            </div>
                        </div>
                    </div>
                </div>
            </template>

            <!-- PASO 4: FINALIZACIÓN / PREVISUALIZACIÓN -->
            <template if:true={isStep4}>
                <div class="pdf-preview-container radius-8">
                    <div class="pdf-page">
                        <!-- HEADER DEL PDF -->
                        <div class="pdf-header slds-grid slds-grid_align-spread slds-grid_vertical-align-end">
                            <div>
                                <h1 class="slds-text-heading_large slds-font-weight_bold" style="color: #0070d2;">PYATZ</h1>
                                <p class="slds-text-title_caps">Ingeniería Tecnológica</p>
                            </div>
                            <div class="slds-text-align_right">
                                <p class="slds-font-weight_bold">FOLIO: PRE-4606</p>
                                <p class="pdf-text-small">Fecha de Emisión: 10/02/2026</p>
                            </div>
                        </div>

                        <!-- INFO ESTRATEGIA -->
                        <div class="slds-m-bottom_medium">
                            <h2 class="slds-text-heading_small slds-font-weight_bold">Resumen de Cotización Técnica</h2>
                            <p class="slds-m-top_x-small"><strong>Estrategia:</strong> {estrategiaVenta} - Extraordinario</p>
                            <p><strong>Tipo de Orden:</strong> Bomberazo / Emergencia</p>
                        </div>

                        <!-- SECCIÓN: DATOS TÉCNICOS -->
                        <div class="pdf-section-title">Datos Generales</div>
                        <div class="slds-grid slds-wrap">
                            <div class="slds-col slds-size_1-of-2">
                                <p class="pdf-text-small">Asunto:</p>
                                <p class="slds-font-weight_bold">Instalación Hidrosanitaria Liverpool Polanco</p>
                            </div>
                            <div class="slds-col slds-size_1-of-2">
                                <p class="pdf-text-small">Cliente:</p>
                                <p class="slds-font-weight_bold">LIVERPOOL MÉXICO</p>
                            </div>
                        </div>

                        <!-- SECCIÓN: SERVICIOS -->
                        <div class="pdf-section-title">Servicios y Artículos</div>
                        <table class="slds-table slds-table_bordered slds-no-row-hover pdf-text-small">
                            <thead>
                                <tr class="slds-line-height_reset">
                                    <th>Descripción</th>
                                    <th>Cant.</th>
                                    <th>Unitario</th>
                                    <th>Importe</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Servicio de Desazolve Industrial (Nocturno)</td>
                                    <td>1</td>
                                    <td>$12,500.00</td>
                                    <td>$12,500.00</td>
                                </tr>
                                <tr>
                                    <td>Suministro de Sellador de Alta Presión</td>
                                    <td>5</td>
                                    <td>$450.00</td>
                                    <td>$2,250.00</td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- SECCIÓN: MEMORIA DESCRIPTIVA -->
                        <div class="pdf-section-title">Memoria Descriptiva y Evidencia</div>
                        <div class="slds-p-around_small slds-border_bottom pdf-text-small">
                            <p>Se realizó levantamiento técnico detectando obstrucción en tubería principal de 4". Se requiere intervención inmediata para evitar afectación en área de restaurante...</p>
                        </div>

                        <!-- TOTALES -->
                        <div class="pdf-total-box">
                            <div class="slds-grid slds-grid_align-end">
                                <div class="slds-col slds-size_1-of-3">
                                    <div class="slds-grid slds-grid_align-spread">
                                        <span>Subtotal:</span>
                                        <span class="slds-font-weight_bold">$14,750.00</span>
                                    </div>
                                    <div class="slds-grid slds-grid_align-spread">
                                        <span>IVA (16%):</span>
                                        <span class="slds-font-weight_bold">$2,360.00</span>
                                    </div>
                                    <div class="slds-grid slds-grid_align-spread slds-m-top_x-small" style="font-size: 1.1rem; color: #0070d2;">
                                        <span class="slds-font-weight_bold">TOTAL:</span>
                                        <span class="slds-font-weight_bold">$17,110.00</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- PIE DE PÁGINA -->
                        <div style="position: absolute; bottom: 3rem; left: 3rem; right: 3rem;" class="slds-text-align_center border-top slds-p-top_medium">
                            <p class="pdf-text-small">PYATZ INGENIERÍA TECNOLÓGICA - Av. Insurgentes Sur 123, CDMX - www.pyatz.com.mx</p>
                        </div>
                    </div>
                </div>
            </template>

        </div>

        <!-- MODAL: NUEVA LÍNEA DEL PRESUPUESTO (SE MANTIENE IGUAL) -->
        <template if:true={showModal}>
            <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open slds-modal_medium">
                <div class="slds-modal__container">
                    <header class="slds-modal__header custom-modal-header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={handleCloseModal}>
                            <lightning-icon icon-name="utility:close" size="small" variant="inverse"></lightning-icon>
                            <span class="slds-assistive-text">Cerrar</span>
                        </button>
                        <h2 class="slds-text-heading_medium slds-hyphenate">Nueva linea del presupuesto</h2>
                        <div class="slds-grid slds-grid_center slds-m-top_x-small">
                            <lightning-icon icon-name="utility:settings" size="xx-small" class="slds-m-right_x-small"></lightning-icon>
                            <span class="slds-text-title">nueva linea del presupuesto</span>
                        </div>
                    </header>
                    <div class="slds-modal__content slds-p-around_large bg-light-gray">
                        <div class="slds-grid slds-grid_vertical-align-center slds-m-bottom_medium">
                            <div class="blue-square slds-m-right_small"></div>
                            <h3 class="slds-text-title_bold slds-text-heading_small">Añadir productos y servicios</h3>
                        </div>
                        <div class="custom-checkbox-card slds-m-bottom_medium bg-white">
                            <lightning-input type="checkbox" label="Permitir agregar productos y servicios de otras lineas de negocio"></lightning-input>
                        </div>
                        <div class="section-card slds-p-around_medium slds-m-bottom_medium">
                            <p class="slds-text-title_bold slds-m-bottom_x-small">Buscar articulo o servicio</p>
                            <lightning-input type="search" placeholder="Escriba aquí para buscar..." variant="label-hidden"></lightning-input>
                        </div>
                        <div class="section-card slds-p-around_medium slds-m-bottom_medium">
                            <div class="slds-grid slds-grid_vertical-align-center slds-grid_align-spread">
                                <span class="slds-text-title_bold">¿Introducir precio unitario o el precio total?</span>
                                <div class="slds-grid">
                                    <lightning-input type="checkbox" label="UNITARIO" checked={isUnitario} onchange={handlePriceType} class="slds-m-right_large"></lightning-input>
                                    <lightning-input type="checkbox" label="TOTAL" checked={isTotal} onchange={handlePriceType}></lightning-input>
                                </div>
                            </div>
                            <div class="slds-m-top_medium">
                                <lightning-button label="Aplicar descuento" icon-name="utility:discount" variant="neutral" class="btn-azul-pastel"></lightning-button>
                            </div>
                        </div>
                        <div class="section-card slds-m-bottom_none no-radius-bottom">
                            <table class="slds-table slds-table_bordered slds-table_cell-buffer slds-no-row-hover">
                                <thead>
                                    <tr class="slds-line-height_reset">
                                        <th scope="col" style="width: 3rem;">
                                            <lightning-input type="checkbox" variant="label-hidden"></lightning-input>
                                        </th>
                                        <th scope="col">Sede</th>
                                        <th scope="col">Cantidad(Frecuencia)</th>
                                        <th scope="col">Importe total</th>
                                        <th scope="col">Total(Sin impuestos)</th>
                                        <th scope="col">Impuestos</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <template for:each={modalTableData} for:item="row">
                                        <tr key={row.id}>
                                            <td>
                                                <lightning-input type="checkbox" variant="label-hidden"></lightning-input>
                                            </td>
                                            <td class="slds-text-title_bold">{row.sede}</td>
                                            <td>
                                                <lightning-input type="number" value={row.cantidad} 
                                                    data-id={row.id} data-field="cantidad" onchange={handleModalInputChange}
                                                    variant="label-hidden" style="width: 80px;" class="custom-input">
                                                </lightning-input>
                                            </td>
                                            <td>
                                                <lightning-input type="number" formatter="currency" step="0.01" value={row.importeTotal} 
                                                    data-id={row.id} data-field="importeTotal" onchange={handleModalInputChange}
                                                    variant="label-hidden" class="custom-input">
                                                </lightning-input>
                                            </td>
                                            <td>
                                                <lightning-formatted-number value={row.totalSinImpuestos} format-style="currency" currency-code="USD" class="slds-p-horizontal_small"></lightning-formatted-number>
                                            </td>
                                            <td>
                                                <div style="width: 80px;">
                                                    <lightning-input type="number" value={row.impuestos} 
                                                        data-id={row.id} data-field="impuestos" onchange={handleModalInputChange}
                                                        field-level-help="Porcentaje de IVA/Retención" variant="label-hidden" class="custom-input" step="1">
                                                    </lightning-input>
                                                </div>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </div>
                        <div class="section-card slds-p-around_medium slds-m-bottom_medium no-radius-top border-top-none">
                            <p class="slds-text-title_bold slds-m-bottom_small">Descripcion adicional:</p>
                            <lightning-input-rich-text variant="bottom-toolbar" class="radius-8"></lightning-input-rich-text>
                            <div class="slds-m-top_large slds-border_top slds-p-top_medium">
                                <div class="custom-dropdown-trigger" onclick={toggleIndicaciones}>
                                    <div class="slds-grid slds-grid_vertical-align-center slds-grid_align-spread">
                                        <div class="slds-grid slds-grid_vertical-align-center">
                                            <lightning-icon icon-name="utility:record_update" size="x-small" class="slds-m-right_small icon-blue"></lightning-icon>
                                            <span class="slds-text-title_bold text-blue">Indicaciones ejecución</span>
                                        </div>
                                        <lightning-icon icon-name={dropdownIcon} size="xx-small" class="slds-m-left_x-small"></lightning-icon>
                                    </div>
                                </div>
                                <template if:true={showIndicaciones}>
                                    <div class="slds-p-around_medium slds-m-top_x-small bg-white border-all radius-8 shadow-inner">
                                        <p class="slds-text-title_bold slds-m-bottom_small">Zona afectada(Separacion por comas)</p>
                                        <div class="chips-container slds-m-bottom_small">
                                            <template for:each={zonasAfectadas} for:item="zona">
                                                <span key={zona} class="slds-badge slds-m-right_xx-small">
                                                    {zona}
                                                    <button class="slds-button slds-button_icon slds-button_icon-small" data-name={zona} onclick={removeZona}>
                                                        <lightning-icon icon-name="utility:close" size="xx-small"></lightning-icon>
                                                    </button>
                                                </span>
                                            </template>
                                        </div>
                                        <lightning-input type="text" value={zonaInput} onchange={handleZonaInput} placeholder="Escriba una zona y ponga coma..." variant="label-hidden"></lightning-input>
                                        <div class="slds-m-top_medium">
                                            <lightning-input type="checkbox" label="Convertir estas zonas en zonas de la instalacion" class="slds-text-title_bold"></lightning-input>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                    <footer class="slds-modal__footer bg-white">
                        <lightning-button label="Cancelar" icon-name="utility:close" variant="neutral" onclick={handleCloseModal} class="slds-m-right_x-small"></lightning-button>
                        <lightning-button label="Guardar" icon-name="utility:save" variant="brand" onclick={handleCloseModal}></lightning-button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>

        <!-- FOOTER STICKY PARA ACCIONES -->
        <div class="sticky-footer slds-p-around_medium">
            <div class="slds-grid slds-grid_align-spread">
                <lightning-button 
                    label="Cancelar" 
                    icon-name="utility:close" 
                    variant="neutral"
                    onclick={handleCancel}>
                </lightning-button>
                <lightning-button 
                    label={nextButtonLabel} 
                    icon-name="utility:forward" 
                    icon-position="right" 
                    variant="brand"
                    onclick={handleNext}>
                </lightning-button>
            </div>
        </div>
    </div>
</template>