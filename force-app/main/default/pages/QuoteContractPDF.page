<apex:page standardController="Quote" extensions="QuoteContractPDFController" renderAs="pdf" showHeader="false" sidebar="false" standardStylesheets="false" applyBodyTag="false" applyHtmlTag="false">
    <html>
        <head>
            <style type="text/css">
                @page { 
                    size: letter; 
                    margin: 0; 
                    @bottom-right {
                        content: "Página " counter(page) " de " counter(pages);
                        font-family: 'Helvetica', 'Arial', sans-serif;
                        font-size: 8pt;
                        color: #666;
                        padding-right: 30pt;
                        padding-bottom: 20pt;
                    }
                }
                body { font-family: 'Helvetica', 'Arial', sans-serif; font-size: 10pt; color: #333; line-height: 1.3; margin: 0; padding: 0; }
                .header-img { position: fixed; top: 0; left: 0; width: 100%; height: 3.8cm; display: block; }
                .footer-img { position: fixed; bottom: 0; left: 0; width: 100%; height: 3.5cm; display: block; }
                .content-body { padding: 4cm 30pt 3.8cm 30pt; }
                .title-contract { font-size: 16pt; font-weight: bold; margin-bottom: 2pt; color: #000; text-transform: uppercase; }
                .line-business { font-size: 11pt; color: #333; margin-bottom: 12pt; font-weight: normal; }
                .table-services { width: 100%; border-collapse: collapse; margin-top: 15pt; }
                .table-services th { background-color: #D4EDDA; color: #333; padding: 8pt; border: 0.5pt solid #fff; text-align: center; font-size: 9pt; }
                .table-services td { padding: 8pt; border-bottom: 0.5pt solid #eee; vertical-align: top; }
                .totals-box { width: 250pt; float: right; margin-top: 10pt; page-break-inside: avoid; }
                .signature-section { margin-top: 40pt; width: 100%; page-break-inside: avoid; }
                .sig-box { width: 45%; text-align: center; display: inline-block; vertical-align: bottom; }
                .sig-line { border-top: 1px solid #333; margin: 0 20pt; padding-top: 5pt; font-size: 9pt; }
                .spacer { width: 8%; display: inline-block; }
            </style>
        </head>
        <body>
            <img src="/servlet/servlet.ImageServer?id=015V9000005wj9x&oid={!$Organization.Id}" class="header-img" />
            <img src="/servlet/servlet.ImageServer?id=015V9000005wjDB&oid={!$Organization.Id}" class="footer-img" />

            <div class="content-body">
                <div class="title-contract">CONTRATO DE SERVICIOS No. {!quoteRecord.QuoteNumber}</div>
                <div class="line-business">{!quoteRecord.Business_Lines_Selected__c}</div>

                <div style="margin-top: 5pt; font-size: 10pt;">
                    <div><strong>Agente Responsable:</strong> {!firmanteNombre}</div>
                    <div><strong>Fecha:</strong> {!fechaHoy}</div>
                </div>

                <div style="font-size: 14pt; font-weight: bold; margin-top: 15pt;">{!quoteRecord.Account.Name}</div>
                <div style="font-size: 11pt; margin-top: 5pt;"><strong>Sede:</strong> {!quoteRecord.Technical_Sedes__c}</div>

                <div class="section-title" style="font-size: 12pt; font-weight: bold; margin-top: 20pt; color: #0070d2;">Servicios Contratados</div>
                <table class="table-services">
                    <thead>
                        <tr>
                            <th width="{!IF(config['show_line_prices'], '50%', '90%')}">CONCEPTO / DESCRIPCIÓN</th>
                            <th width="10%">CANT</th>
                            <apex:outputPanel rendered="{!config['show_line_prices']}" layout="none">
                                <th width="20%">P. UNITARIO (NETO)</th>
                                <th width="20%">IMPORTE (CON I.V.A.)</th>
                            </apex:outputPanel>
                        </tr>
                    </thead>
                    <tbody>
                        <apex:repeat value="{!selectedLineItems}" var="item">
                            <tr>
                                <td>
                                    <strong>{!item.Product2.Name}</strong><br/>
                                    <span style="font-size: 8pt; color: #666;"><apex:outputText value="{!item.Description}" escape="false"/></span>
                                </td>
                                <td align="center">{!item.Quantity}</td>
                                <apex:outputPanel rendered="{!config['show_line_prices']}" layout="none">
                                    <td align="right"><apex:outputText value="{0, number, currency}"><apex:param value="{!item.UnitPrice}" /></apex:outputText></td>
                                    <td align="right"><strong><apex:outputText value="{0, number, currency}"><apex:param value="{!item.TotalPrice * 1.16}" /></apex:outputText></strong></td>
                                </apex:outputPanel>
                            </tr>
                        </apex:repeat>
                    </tbody>
                </table>

                <apex:outputPanel rendered="{!config['show_total']}">
                    <div class="totals-box">
                        <table style="width: 100%;">
                            <tr>
                                <td style="padding: 8pt 0; text-align: left; font-size: 12pt; font-weight: bold; color: #0070d2;">TOTAL DEL CONTRATO</td>
                                <td style="padding: 8pt 0; text-align: right; font-size: 12pt; font-weight: bold; color: #0070d2; border-bottom: 2pt solid #0070d2;">
                                    <apex:outputText value="{0, number, currency}"><apex:param value="{!totalContrato}" /></apex:outputText>
                                </td>
                            </tr>
                        </table>
                    </div>
                </apex:outputPanel>
                <div style="clear: both;"></div>

                <!-- SECCIÓN DE FIRMAS -->
                <div class="signature-section">
                    <div class="sig-box">
                        <div class="sig-line">EL CLIENTE (FIRMA)</div>
                        <div style="font-size: 8pt; margin-top: 3pt;"><apex:outputText value="{!firmanteCliente}"/></div>
                    </div>
                    <div class="spacer"></div>
                    <div class="sig-box">
                        <div style="margin-bottom: 10pt;">
                            <div style="font-family: cursive; font-size: 16pt;">{!firmanteNombre}</div>
                        </div>
                        <div class="sig-line">
                            POR PYATZ: {!firmanteNombre}<br/>
                            {!firmanteCargo}
                        </div>
                    </div>
                </div>
            </div>
        </body>
    </html>
</apex:page>